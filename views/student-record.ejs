<html lang="en">

    <%- include('./partials/head.ejs') %>

<body>    
    <div class="student-record-parent">
        <%- include('./partials/navigation.ejs') %>

        <div class="student-record-form">
            <h1 class="student-record-title">Student Record Management</h1>

            <div class="student-record-subcontainer">
                <form class="student-record-subcontainer-side">

                    <h2>Search for Student</h2>

                    <div>
                        <label for="firstname">First Name</label>
                        <input type="text" name="firstname" class="name">
                    </div>

                    <div>
                        <label for="lastname">Last Name</label>
                        <input type="text" name="lastname" class="last">
                    </div>

                    <button class="sub">Search</button>

                    <div class="search-results">

                    </div>
                </form>

                <form action="/student-record" method="POST" class="student-record-subcontainer-info">

                    <div class="student-record-subcontainer-body">
                        <div class="info-input">
                            <label for="department">Department</label><br>
                            <select name="department" id="department" required>
                                <option value="opt1">Option 1</option>
                            </select>
                        </div>

                        <div class="info-input">
                            <label for="lrn">LRN</label><br>
                            <input type="number" name="lrn" required>
                        </div>

                        <div class="info-input">
                            <label for="grade">Grade/Level</label><br>
                            <select name="grade" id="grade" required>
                                <option value="opt1">Option 1</option>
                            </select>
                        </div>

                        <div class="info-input">
                            <label for="section">Section</label><br>
                            <select name="section" id="section" required>
                                
                            </select>
                        </div>

                        <h2 class="personal-title">Personal Information</h2>

                        <div class="info-input">
                            <label for="lastname">Last Name</label><br>
                            <input type="text" name="lastname" required>
                        </div>

                        <div class="info-input">
                            <label for="dob">DOB</label><br>
                            <input type="date" name="dob" required>
                        </div>

                        <div class="info-input">
                            <label for="firstname">First Name</label><br>
                            <input type="text" name="firstname" required>
                        </div>

                        <div class="info-input">
                            <label for="birthplace">Place of Birth</label><br>
                            <input type="text" name="birthplace" required>
                        </div>

                        <div class="info-input">
                            <label for="middlename">Middle Name</label><br>
                            <input type="text" name="middlename" required>
                        </div>

                        <div class="info-input">
                            <label for="religion">Religion</label><br>
                            <input type="text" name="religion" required>
                        </div>

                        <div class="info-input" style="flex: 100%;">
                            <label for="address">Complete Address</label><br>
                            <input type="text" name="address" style="width: 80%" required>
                        </div>

                        <div class="info-input">
                            <label for="nationality">Nationality</label><br>
                            <input type="text" name="nationality" required>
                        </div>

                        <div class="radio-input">
                            <p>Gender:</p>
                            <input type="radio" id="male" name="gender" value="male" required>
                            <label for="male">Male</label>
                            <input type="radio" id="female" name="gender" value="female">
                            <label for="female">Female</label>
                        </div>

                        <div class="info-input">
                            <label for="mobile">Mobile Number</label><br>
                            <input type="number" name="mobile" min="0" required>
                        </div>

                        <div class="info-input">
                            <label for="email">Email Address</label><br>
                            <input type="email" name="email" required>
                        </div>

                        <button>Submit</button>

                    </div>

                    
                </form>

            </div>
        </div>
    </div>

    <script>

        const sections = '<%- JSON.stringify(sections) %>'
        const sectionsArray = JSON.parse(sections)
        
        const sectionSelect = document.getElementById('section')
        const searchResults = document.querySelector(".search-results")
        const results = '<%- JSON.stringify(record) %>'
        const resultsArray = JSON.parse(results)

        sectionsArray.forEach(section => {
            const opt = document.createElement("option")
            opt.text = section.name
            opt.setAttribute('value', section.name) 
            sectionSelect.add(opt)
        })

        if (Array.isArray(resultsArray)) {
            resultsArray.forEach(result => {
            const a = document.createElement('a')
            const link = document.createTextNode(`${result.firstname} ${result.lastname}`)
            a.appendChild(link)
            a.href = `/student-record/${result._id}`
            searchResults.appendChild(a)
        })
        }             
    </script>
    
</body>
</html>